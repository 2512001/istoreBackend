# ğŸ“¦ iPhone Store â€” Backend (Node.js + Express + MongoDB)

This is the **backend REST API** for the iPhone Store E-commerce application.  
It provides **authentication, product management, cart, orders, payments, reviews, and admin analytics**.

Built using **Node.js, Express, MongoDB, Cloudinary & Razorpay**.

---

# ğŸš€ Features

### ğŸ‘¤ Authentication
- Register, Login, Logout
- JWT-based authentication (Access & Refresh Tokens)
- User profile fetch & update

### ğŸ“± Product Management
- Get all products with filtering & pagination
- Get single product details
- Admin-protected: Create, Update & Delete products
- Cloudinary image uploads

### ğŸ›’ Cart
- Add to cart
- Update quantity
- Remove cart items
- Fetch user cart

### ğŸ§¾ Orders & Payments
- Create order
- Razorpay payment integration
- Server-side payment signature verification
- Cancel orders

### ğŸ“Š Admin Panel APIs
- Revenue analytics
- Recent orders
- Low-stock alerts
- Top-selling products

---

# ğŸ§­ Getting Started (Beginner-Friendly)

## 1ï¸âƒ£ Prerequisites
Before running backend, install:

- **Node.js** v14 or higher  
- **npm** or **yarn**
- **MongoDB** (Local or Atlas)
- **Cloudinary Account**
- **Razorpay Test Account** (optional for development)

---

# 2ï¸âƒ£ Installation & Setup

### ğŸ‘‰ Step 1: Clone Backend Repo
```bash
git https://github.com/2512001/istoreBackend.git
cd iphone-store-backend

ğŸ‘‰ Step 2: Install dependencies
npm install

ğŸ‘‰ Step 3: Create .env

Create .env file in root of backend folder and paste:

# Server
PORT=3000
NODE_ENV=development

# MongoDB
MONGODB_URI=mongodb://127.0.0.1:27017/iphone-store

# JWT Secrets
JWT_SECRET=your_jwt_secret
JWT_REFRESH_SECRET=your_refresh_jwt_secret
JWT_EXPIRES_IN=5h

# Cloudinary
CLOUDINARY_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

# Razorpay (Optional but recommended)
RAZORPAY_KEY_ID=rzp_test_xxxxxx
RAZORPAY_KEY_SECRET=your_razorpay_secret

# Admin Setup (optional)
ADMIN_SECRET=super_secret_key


ğŸ“Œ Do NOT commit .env file to GitHub!

ğŸ‘‰ Step 4: Start Backend Server
Development (auto restart with nodemon)
npm run dev

Production
npm start

ğŸŒ API Base URL
http://localhost:3000/api

ğŸ“ Backend Folder Structure
backend/
â”œâ”€â”€ app.js              # Entry point
â”œâ”€â”€ package.json
â”œâ”€â”€ .env                # Environment vars (gitignored)
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ db.js           # MongoDB connection
â”‚   â””â”€â”€ cloudinary.js   # Cloudinary setup
â”œâ”€â”€ controllers/        # Logic for auth, products, orders, cart, admin
â”œâ”€â”€ middleware/         # Auth middleware, validators, error handler
â”œâ”€â”€ models/             # Mongoose models (User, Product, Cart, Order)
â”œâ”€â”€ routes/             # All API routes
â”œâ”€â”€ utils/              # Helpers (JWT, payment verify)
â””â”€â”€ scripts/            # Seed scripts / create admin

ğŸ”Œ API Endpoints (Important)
ğŸ” Auth Routes
Method	Endpoint	Description
POST	/api/auth/register	Register
POST	/api/auth/login	Login
GET	/api/auth/profile	User profile (protected)
POST	/api/auth/logout	Logout
PUT	/api/auth/:id	Update user
ğŸ“± Product Routes
Method	Endpoint	Description
GET	/api/products	Get all products
GET	/api/products/:id	Product details
GET	/api/products/pageCount	Total pages
POST	/api/products	Create product (admin)
PUT	/api/products/:id	Update product (admin)
DELETE	/api/products/:id	Delete (admin)
ğŸ›’ Cart Routes
Method	Endpoint	Description
POST	/api/cart/	Add to cart
PATCH	/api/cart/:cartId	Update quantity/remove
GET	/api/cart/user/:userId	User cart
ğŸ§¾ Order Routes
Method	Endpoint	Description
GET	/api/orders	Fetch user orders
POST	/api/orders	Create order (starts Razorpay)
POST	/api/orders/payment/verify	Verify payment
GET	/api/orders/:id	Get order by ID
PATCH	/api/orders/:id/cancel	Cancel order
ğŸ› ï¸ Admin Routes
Method	Endpoint	Description
GET	/api/admin/analytics	Revenue, stats
GET	/api/admin/low-stock	Low stock items
GET	/api/admin/recent-orders	Last orders
GET	/api/admin/topSellproduct	Top selling products
ğŸ§ª Create Sample Admin (Optional)

Add the script in scripts/ folder:

node scripts/createAdmin.js

ğŸª² Troubleshooting Guide
âŒ MongoDB not connecting?

Check MONGODB_URI

Make sure MongoDB service is running or Atlas IP is whitelisted

âŒ Cloudinary upload fails?

Wrong CLOUDINARY_* keys

Missing multer upload logic

âŒ Razorpay signature invalid?

Ensure you're using correct RAZORPAY_KEY_SECRET

âŒ CORS issue with frontend?

Add in app.js:

const cors = require("cors");
app.use(cors({ origin: "*" }));

âŒ JWT errors?

Tokens expired â†’ requires re-login

Missing Authorization: Bearer <token>

ğŸ¤ Contributing

Fork the repository

Create a feature branch

Commit changes

Push & create PR

ğŸ“ License

MIT License. See LICENSE for more details.

If you want, I can also generate:
âœ… .env.example file
âœ… Postman Collection for all APIs
âœ… Seed Script (createAdmin.js, seedProducts.js)
Just tell me!


---

âœ”ï¸ **This is now your complete backend README â€” clean, professional, beginner-friendly, ready to use.**
